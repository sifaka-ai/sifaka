"""
Chain Result Module

Standard result type for Sifaka's chain system.

## Overview
This module provides the ChainResult class which represents the result of running a chain,
including the generated output, validation results, and optional critique details.

## Components
1. **ChainResult**: Main result class that encapsulates chain execution results
2. **RuleResult**: Individual rule validation results
3. **CritiqueDetails**: Optional details from critic refinement

## Usage Examples
```python
from sifaka.chain import ChainResult
from sifaka.rules import RuleResult

# Create a chain result
result = ChainResult(
    output="Generated text output",
    rule_results=[
        RuleResult(
            rule_name="length_rule",
            passed=True,
            details={"length": 100}
        )
    ],
    critique_details={
        "feedback": "Good text, but could be more concise",
        "suggestions": ["Remove redundant phrases", "Use active voice"]
    }
)

# Access result properties
print(f"Output: {result.output}")
print(f"All rules passed: {all(r.passed for r in result.rule_results)}")
if result.critique_details:
    print(f"Critique feedback: {result.critique_details.get('feedback', '')}")
```

## Error Handling
- No specific exceptions raised by this module

## Configuration
- output: The generated output from the chain
- rule_results: List of validation results from rules
- critique_details: Optional dictionary of critique details
"""

from dataclasses import dataclass
from typing import Generic, List, Optional, TypeVar, Dict, Any

from ..rules import RuleResult

OutputType = TypeVar("OutputType")


@dataclass
class ChainResult(Generic[OutputType]):
    """
    Result from running a chain, including the output and validation details.

    Detailed description of what the class does, including:
    - Represents the complete result of running a chain
    - Stores generated output and validation results
    - Includes optional critique details from a critic

    Attributes:
        output (OutputType): The generated output from the chain
        rule_results (List[RuleResult]): List of validation results from rules
        critique_details (Optional[Dict[str, Any]]): Optional dictionary of critique details

    Type parameters:
        OutputType: The type of output generated by the chain

    Example:
        ```python
        from sifaka.chain import ChainResult
        from sifaka.rules import RuleResult

        # Create a chain result
        result = ChainResult(
            output="Generated text output",
            rule_results=[
                RuleResult(
                    rule_name="length_rule",
                    passed=True,
                    details={"length": 100}
                )
            ],
            critique_details={
                "feedback": "Good text, but could be more concise",
                "suggestions": ["Remove redundant phrases", "Use active voice"]
            }
        )

        # Access result properties
        print(f"Output: {result.output}")
        print(f"All rules passed: {all(r.passed for r in result.rule_results)}")
        if result.critique_details:
            print(f"Critique feedback: {result.critique_details.get('feedback', '')}")
        ```
    """

    output: OutputType
    rule_results: List[RuleResult]
    critique_details: Optional[Dict[str, Any]] = None
